check process resque_worker_<%= @worker %>
  with pidfile "<%= @deploy[:deploy_to] %>/shared/pids/grantoo_resque_<%= @worker %>.pid"
  start program = "/usr/bin/env RUBY_GC_MALLOC_LIMIT=50000000 HOME=/home/deploy PATH=/usr/local/bin:/usr/bin:/bin:$PATH /bin/sh -l -c 'cd <%= @deploy[:deploy_to] %>/current; RAILS_ENV=<%= @deploy[:rails_env] %> QUEUE=<%= @queues%> VERBOSE=1 PIDFILE=<%= @deploy[:deploy_to] %>/shared/pids/grantoo_resque_<%= @worker %>.pid nohup bundle exec rake environment resque:work >><%= @deploy[:deploy_to] %>/shared/log/resque_worker.log 2>&1'" as uid deploy and gid <%= @group %> with timeout 180 seconds
  stop program = "/bin/bash 'pkill -QUIT -f resque-1.25; rm -f \'<%= @deploy[:deploy_to] %>/shared/pids/grantoo_resque_<%= @worker %>.pid\'; exit 0;'" with timeout 60 seconds
  if totalmem is greater than 1024 MB for 10 cycles then restart # eating up memory?
  group resque_workers